---
title: Traffic Data Analysis
output: html_document
---

```{r}
library(reshape2)
library(ggplot2)
library(dplyr)
```
```{r}
mydata <- read.csv("all-semi-unique.csv")
nrow(mydata)
ncol(mydata)
names(mydata)
head(mydata)
tail(mydata)
```

Having a look at the internal structure and types of the columns.
```{r}
str(mydata)
```
All the columns that are of type 'Factor' and have only one level are going to be removed, they are not adding any new information to the data or creating patterns. Clean data by removing them.
Those columns are : ad.bgcl , ad.bgcls, ad.fncl, ad.fncls, ad.logo, ad.logo2x, ad.logoAndroidS, ad.logoAndroidH, ad.cm, ad.url, rd.cl.

```{r}
mydata <- subset.data.frame(mydata, select = -c(ad.bgcl , ad.bgcls, ad.fncl, ad.fncls, ad.logo, ad.logo2x, ad.logoAndroidS, ad.logoAndroidH, ad.cm, ad.url, rd.cl))
```
Check if there are still other columns that have no unique values. 
```{r}
col_ct = sapply(mydata, function(x) length(unique(x)))
length(col_ct[col_ct==1])
names(col_ct[col_ct==1])
```
Remove those columns.
```{r}
mydata = mydata[, !names(mydata) %in% names(col_ct[col_ct==1])]
```
Check for duplicate rows.
```{r}
nrow(mydata) - nrow(unique(mydata))
```
Plotting numeric columns
```{r}
ncol(mydata)
numeric_data <- mydata[, sapply(mydata, is.numeric)]
d <- melt(numeric_data)
ggplot(d,aes(x = value)) + 
    facet_wrap(~variable,scales = "free") + 
    geom_histogram()
```

Checking ratio of NAs for every column
```{r}
sapply(mydata, function(x) sum(is.na(x))/(nrow(mydata)))
```
check the values for rd.rp.rpImg 
check the uniqueness of the values for each column